# Домашнее задание к занятию «Хранение в K8s»

## Задание 1. Volume: обмен данными между контейнерами в поде
### Задача

Создать Deployment приложения, состоящего из двух контейнеров, обменивающихся данными.

### Шаги выполнения
1. Создать Deployment приложения, состоящего из контейнеров busybox и multitool.
2. Настроить busybox на запись данных каждые 5 секунд в некий файл в общей директории.
3. Обеспечить возможность чтения файла контейнером multitool.


### Что сдать на проверку
- Манифесты:
  - `containers-data-exchange.yaml`
- Скриншоты:
  - описание пода с контейнерами (`kubectl describe pods data-exchange`)
  - вывод команды чтения файла (`tail -f <имя общего файла>`)

------
## Решение Задание 1
[containers-data-exchange.yaml](https://github.com/Frodoq/kuber-homeworks_1.1_03.25/blob/main/2.1/containers-data-exchange.yaml)
<img width="3420" height="1882" alt="image" src="https://github.com/user-attachments/assets/9a02995d-bc37-494a-aa3b-cc6a336efe8a" />
<img width="3424" height="1158" alt="image" src="https://github.com/user-attachments/assets/fb002051-d993-4f9b-b6cc-d3fc0ae566c5" />
<img width="2138" height="574" alt="image" src="https://github.com/user-attachments/assets/a15d41b5-da36-4875-87a6-82cc825ef9b0" />



## Задание 2. PV, PVC
### Задача
Создать Deployment приложения, использующего локальный PV, созданный вручную.

### Шаги выполнения
1. Создать Deployment приложения, состоящего из контейнеров busybox и multitool, использующего созданный ранее PVC
2. Создать PV и PVC для подключения папки на локальной ноде, которая будет использована в поде.
3. Продемонстрировать, что контейнер multitool может читать данные из файла в смонтированной директории, в который busybox записывает данные каждые 5 секунд. 
4. Удалить Deployment и PVC. Продемонстрировать, что после этого произошло с PV. Пояснить, почему. (Используйте команду `kubectl describe pv`).
5. Продемонстрировать, что файл сохранился на локальном диске ноды. Удалить PV.  Продемонстрировать, что произошло с файлом после удаления PV. Пояснить, почему.


### Что сдать на проверку
- Манифесты:
  - `pv-pvc.yaml`
- Скриншоты:
  - каждый шаг выполнения задания, начиная с шага 2.
- Описания:
  - объяснение наблюдаемого поведения ресурсов в двух последних шагах.

------
## Решение Задание 2
[pv-pvc.yaml](https://github.com/Frodoq/kuber-homeworks_1.1_03.25/blob/main/2.1/pv-pvc.yaml)
1-3 
<img width="3154" height="730" alt="image" src="https://github.com/user-attachments/assets/a290766c-5232-4fa9-8e2b-be32048af41d" />
<img width="2686" height="1584" alt="image" src="https://github.com/user-attachments/assets/2e9af14a-6ed1-4485-9f03-bcb9975b130e" />

4-5
<img width="3332" height="1470" alt="image" src="https://github.com/user-attachments/assets/58f837e2-8d82-42e3-8159-bb69aaa6ab4c" />
<img width="3210" height="496" alt="image" src="https://github.com/user-attachments/assets/d4ccc307-433b-404d-8ebf-469d17544482" />
Пояснение: PV перешел в статус Released из-за политики Retain, которая сохраняет том после удаления PVC для защиты данных
Файл остался на диске после удаления PV, потому что Kubernetes управляет только логическими томами, а данные hostPath хранятся физически на ноде и требуют ручного удаления


## Задание 3. StorageClass
### Задача
Создать Deployment приложения, использующего PVC, созданный на основе StorageClass.

### Шаги выполнения

1. Создать Deployment приложения, состоящего из контейнеров busybox и multitool, использующего созданный ранее PVC.
2. Создать SC и PVC для подключения папки на локальной ноде, которая будет использована в поде.
3. Продемонстрировать, что контейнер multitool может читать данные из файла в смонтированной директории, в который busybox записывает данные каждые 5 секунд.

### Что сдать на проверку
- Манифесты:
  - `sc.yaml`
- Скриншоты:
  - каждый шаг выполнения задания, начиная с шага 2
---

## Решение Задание 3
[sc.yaml](https://github.com/Frodoq/kuber-homeworks_1.1_03.25/blob/main/2.1/sc.yaml)
<img width="3390" height="1818" alt="image" src="https://github.com/user-attachments/assets/b7b642c2-ba24-4dfe-b8dd-edcd39ff58b1" />

Задание 1: Работа с ConfigMaps
Задача
Развернуть приложение (nginx + multitool), решить проблему конфигурации через ConfigMap и подключить веб-страницу.

Шаги выполнения
Создать Deployment с двумя контейнерами
nginx
multitool
Подключить веб-страницу через ConfigMap
Проверить доступность
Что сдать на проверку
Манифесты:
deployment.yaml
configmap-web.yaml
Скриншот вывода curl или браузера
Задание 2: Настройка HTTPS с Secrets
Задача
Развернуть приложение с доступом по HTTPS, используя самоподписанный сертификат.

Шаги выполнения
Сгенерировать SSL-сертификат
openssl req -x509 -nodes -days 365 -newkey rsa:2048 \
  -keyout tls.key -out tls.crt -subj "/CN=myapp.example.com"
Создать Secret
Настроить Ingress
Проверить HTTPS-доступ
Что сдать на проверку
Манифесты:
secret-tls.yaml
ingress-tls.yaml
Скриншот вывода curl -k
Задание 3: Настройка RBAC
Задача
Создать пользователя с ограниченными правами (только просмотр логов и описания подов).

Шаги выполнения
Включите RBAC в microk8s
microk8s enable rbac
Создать SSL-сертификат для пользователя
openssl genrsa -out developer.key 2048
openssl req -new -key developer.key -out developer.csr -subj "/CN={ИМЯ ПОЛЬЗОВАТЕЛЯ}"
openssl x509 -req -in developer.csr -CA {CA серт вашего кластера} -CAkey {CA ключ вашего кластера} -CAcreateserial -out developer.crt -days 365
Создать Role (только просмотр логов и описания подов) и RoleBinding
Проверить доступ
Что сдать на проверку
Манифесты:
role-pod-reader.yaml
rolebinding-developer.yaml
Команды генерации сертификатов
Скриншот проверки прав (kubectl get pods --as=developer)
Шаблоны манифестов с учебными комментариями
1. Deployment с ConfigMap (nginx + multitool)
apiVersion: apps/v1
kind: Deployment
metadata:
  name: web-app
spec:
  replicas: 1
  selector:
    matchLabels:
      app: web-app
  template:
    metadata:
      labels:
        app: web-app
    spec:
      containers:
      - name: nginx
        image: nginx:latest
        ports:
        - containerPort: 80
        volumeMounts:
        - name: nginx-config # ПОДКЛЮЧЕНИЕ ConfigMap
          mountPath: /etc/nginx/conf.d
      volumes:
      - name: nginx-config
        configMap:
          name: nginx-config # УКАЖИТЕ имя созданного ConfigMap
2. ConfigMap для веб-страницы
apiVersion: v1
kind: ConfigMap
metadata:
  name: web-content # ИЗМЕНИТЕ: Укажите имя ConfigMap
  namespace: default # ОПЦИОНАЛЬНО: Укажите namespace, если не default
data:
  # КЛЮЧЕВОЙ МОМЕНТ: index.html будет подключен как файл
  index.html: |
    <!DOCTYPE html>
    <html>
    <head>
      <title>Страница из ConfigMap</title> # ИЗМЕНИТЕ: Заголовок страницы
    </head>
    <body>
      <h1>Привет от Kubernetes!</h1> # ДОБАВЬТЕ: Свой контент страницы
    </body>
    </html>
3. Secret для TLS-сертификата
apiVersion: v1
kind: Secret
metadata:
  name: tls-secret # ИЗМЕНИТЕ при необходимости
type: kubernetes.io/tls
data:
  tls.crt: # ЗАМЕНИТЕ на base64-код сертификата (cat tls.crt | base64 -w 0)
  tls.key: # ЗАМЕНИТЕ на base64-код ключа (cat tls.key | base64 -w 0)
4. Role для просмотра подов
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: pod-viewer # ИЗМЕНИТЕ: Название роли
  namespace: default # ВАЖНО: Role работает только в указанном namespace
rules:
- apiGroups: [""] # КЛЮЧЕВОЙ МОМЕНТ: "" означает core API group
  resources: # РАЗРЕШЕННЫЕ РЕСУРСЫ:
    - pods # Доступ к просмотру подов
    - pods/log # Доступ к логам подов
  verbs: # РАЗРЕШЕННЫЕ ДЕЙСТВИЯ:
    - get # Просмотр отдельных подов
    - list # Список всех подов
    - watch # Мониторинг изменений
    - describe # Просмотр деталей
# ДОПОЛНИТЕЛЬНО: Можно добавить больше правил для других ресурсов
